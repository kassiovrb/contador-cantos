<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Contador de Cantos</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    display: flex;
    flex-direction: column;
    height: 100vh;
}

header {
    background: #222;
    color: white;
    text-align: center;
    padding: 15px;
}

#timer {
    font-size: 32px;
    margin-bottom: 10px;
}

#controls {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
}

.control-btn {
    font-size: 22px;
    padding: 5px 12px;
}

main {
    flex: 1;
    display: flex;
    padding: 10px;
    gap: 10px;
}

#log {
    width: 40%;
    background: white;
    border-radius: 8px;
    padding: 10px;
    overflow-y: auto;
    font-size: 14px;
}

#info {
    width: 60%;
    background: white;
    border-radius: 8px;
    padding: 10px;
    text-align: center;
}

#count {
    font-size: 48px;
    margin: 15px 0;
}

#forecast {
    font-size: 18px;
    color: #555;
}

footer {
    padding: 10px;
}

#countBtn {
    width: 100%;
    height: 90px;
    font-size: 36px;
    background: #1fbf4a;
    color: white;
    border: none;
    border-radius: 15px;
}

#countBtn:active {
    background: #15963a;
}

.small-btns {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
}

.small-btns button {
    font-size: 16px;
    padding: 6px 12px;
}
</style>
</head>

<body>

<header>
    <div id="timer">15:00</div>
    <div id="controls">
        <button class="control-btn" onclick="changeTime(-1)">‚¨áÔ∏è</button>
        <button class="control-btn" onclick="changeTime(1)">‚¨ÜÔ∏è</button>
    </div>
</header>

<main>
    <div id="log">
        <strong>Cantos por minuto</strong>
        <div id="logList"></div>
    </div>

    <div id="info">
        <div>Total de cantos</div>
        <div id="count">0</div>
        <div id="forecast">Previs√£o: 0</div>
    </div>
</main>

<footer>
    <div class="small-btns">
        <button onclick="pause()">‚è∏Ô∏è Pausar</button>
        <button onclick="reset()">üîÑ Zerar</button>
    </div>
    <button id="countBtn" onclick="countCanto()">CONTAR</button>
</footer>

<script>
let totalTime = 15 * 60;
let timeLeft = totalTime;
let timer = null;
let started = false;
let paused = false;

let count = 0;
let minuteCounts = [];
let currentMinute = 0;
let forecastInterval = null;

const timerEl = document.getElementById("timer");
const countEl = document.getElementById("count");
const forecastEl = document.getElementById("forecast");
const logList = document.getElementById("logList");

function updateTimer() {
    let min = Math.floor(timeLeft / 60);
    let sec = timeLeft % 60;
    timerEl.textContent = `${min}:${sec.toString().padStart(2, "0")}`;
}

function startTimer() {
    timer = setInterval(() => {
        if (!paused && timeLeft > 0) {
            timeLeft--;
            updateTimer();

            let elapsed = totalTime - timeLeft;
            let minute = Math.floor(elapsed / 60);

            if (minute > currentMinute) {
                currentMinute = minute;
                minuteCounts.push(0);
                updateLog();
            }
        }
        if (timeLeft <= 0) clearInterval(timer);
    }, 1000);

    forecastInterval = setInterval(updateForecast, 5000);
}

function countCanto() {
    if (!started) {
        started = true;
        minuteCounts.push(0);
        startTimer();
    }

    count++;
    minuteCounts[minuteCounts.length - 1]++;
    countEl.textContent = count;

    // vibra√ß√£o
    if (navigator.vibrate) {
        navigator.vibrate(60);
    }

    updateLog();
    updateForecast();
}

function updateForecast() {
    let elapsed = totalTime - timeLeft;
    if (elapsed <= 0) return;

    let avg = count / elapsed;
    let prediction = Math.round(avg * totalTime);
    forecastEl.textContent = `Previs√£o: ${prediction}`;
}

function updateLog() {
    logList.innerHTML = "";
    minuteCounts.forEach((v, i) => {
        if (i > 0) {
            let div = document.createElement("div");
            div.textContent = `Minuto ${i}: ${v}`;
            logList.appendChild(div);
        }
    });
}

function pause() {
    paused = !paused;
}

function reset() {
    clearInterval(timer);
    clearInterval(forecastInterval);

    totalTime = 15 * 60;
    timeLeft = totalTime;
    count = 0;
    minuteCounts = [];
    currentMinute = 0;
    started = false;
    paused = false;

    countEl.textContent = "0";
    forecastEl.textContent = "Previs√£o: 0";
    logList.innerHTML = "";

    updateTimer();
}

function changeTime(val) {
    if (started) return;
    totalTime += val * 60;
    if (totalTime < 60) totalTime = 60;
    timeLeft = totalTime;
    updateTimer();
}

updateTimer();
</script>

</body>
</html>
