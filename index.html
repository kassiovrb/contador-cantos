<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contador de Cantos</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    margin: 0;
    padding: 10px;
}

#topo {
    text-align: center;
}

#tempo {
    font-size: 60px;
    font-weight: bold;
}

#controleTempo {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    margin-top: 10px;
}

.btnTempo {
    font-size: 24px;
    padding: 5px 12px;
}

#previsao {
    margin-top: 10px;
    font-size: 20px;
    font-weight: bold;
}

#conteudo {
    display: flex;
    margin-top: 15px;
}

#contador {
    width: 55%;
    text-align: center;
}

#minutos {
    width: 45%;
    font-size: 14px;
    padding-left: 10px;
}

/* Label */
#labelCantos {
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 6px;
}

/* Quadrado */
#total {
    font-size: 72px;
    font-weight: bold;
    background: #FFD700;
    color: #000;
    width: 160px;
    height: 160px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 15px auto;
    border-radius: 12px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    transition: background 0.1s ease;
}

.piscar {
    background: #FF3B3B !important;
}

#botoes {
    position: fixed;
    bottom: 120px;
    left: 0;
    width: 100%;
    text-align: center;
}

#btnContar {
    width: 90%;
    height: 200px;
    font-size: 70px;
    background: green;
    color: white;
    border: none;
    border-radius: 18px;
}

#btnsPequenos {
    margin-top: 10px;
}

.btnSmall {
    font-size: 16px;
    padding: 8px 14px;
    margin: 0 5px;
}
</style>
</head>

<body>

<div id="topo">
    <div id="tempo">15:00</div>

    <div id="controleTempo">
        <button class="btnTempo" onclick="ajustarTempo(1)">▲</button>
        <span id="tempoMin">15 min</span>
        <button class="btnTempo" onclick="ajustarTempo(-1)">▼</button>
    </div>

    <div id="previsao">Previsão: 0 cantos</div>
</div>

<div id="conteudo">
    <div id="contador">
        <div id="labelCantos">CANTOS</div>
        <div id="total">0</div>
    </div>

    <div id="minutos"></div>
</div>

<div id="botoes">
    <button id="btnContar" onclick="contar()">CONTAR</button>

    <div id="btnsPequenos">
        <button class="btnSmall" onclick="pausar()">PAUSE</button>
        <button class="btnSmall" onclick="zerar()">ZERAR</button>
    </div>
</div>

<script>
let tempoTotal = 15 * 60;
let tempoRestante = tempoTotal;
let intervalo = null;
let previsaoIntervalo = null;

let totalCantos = 0;
let pausado = false;

let inicio = null;
let inicioMinuto = null;
let cantosMinutoAtual = 0;
let numeroMinuto = 0;

function atualizarTela() {
    let min = Math.floor(tempoRestante / 60);
    let seg = tempoRestante % 60;
    document.getElementById("tempo").innerText =
        String(min).padStart(2, "0") + ":" + String(seg).padStart(2, "0");
}

function ajustarTempo(valor) {
    if (intervalo) return;
    let minutos = tempoTotal / 60 + valor;
    if (minutos < 1) return;
    tempoTotal = minutos * 60;
    tempoRestante = tempoTotal;
    document.getElementById("tempoMin").innerText = minutos + " min";
    atualizarTela();
}

function iniciarTimer() {
    inicio = Date.now();
    inicioMinuto = inicio;

    intervalo = setInterval(() => {
        if (!pausado) {
            tempoRestante--;
            atualizarTela();
            verificarMinuto();

            if (tempoRestante <= 0) {
                clearInterval(intervalo);
                clearInterval(previsaoIntervalo);
            }
        }
    }, 1000);

    previsaoIntervalo = setInterval(atualizarPrevisao, 5000);
}

function contar() {
    if (navigator.vibrate) navigator.vibrate(50);

    if (!intervalo) iniciarTimer();

    totalCantos++;
    cantosMinutoAtual++;

    const totalEl = document.getElementById("total");
    totalEl.innerText = totalCantos;

    totalEl.classList.add("piscar");
    setTimeout(() => totalEl.classList.remove("piscar"), 120);
}

function verificarMinuto() {
    let agora = Date.now();
    let passou = Math.floor((agora - inicioMinuto) / 60000);

    if (passou >= 1) {
        numeroMinuto++;
        const div = document.getElementById("minutos");
        div.innerHTML += `<div>${numeroMinuto}º minuto: ${cantosMinutoAtual} cantos</div>`;
        cantosMinutoAtual = 0;
        inicioMinuto = agora;
    }
}

function atualizarPrevisao() {
    if (!inicio) return;

    let tempoDecorrido = (Date.now() - inicio) / 1000;
    if (tempoDecorrido <= 0) return;

    let mediaPorSegundo = totalCantos / tempoDecorrido;
    let previsao = Math.round(mediaPorSegundo * tempoTotal);

    document.getElementById("previsao").innerText =
        "Previsão: " + previsao + " cantos";
}

function pausar() {
    pausado = !pausado;
}

function zerar() {
    clearInterval(intervalo);
    clearInterval(previsaoIntervalo);

    intervalo = null;
    previsaoIntervalo = null;

    tempoRestante = tempoTotal;
    totalCantos = 0;
    pausado = false;
    inicio = null;
    inicioMinuto = null;
    cantosMinutoAtual = 0;
    numeroMinuto = 0;

    document.getElementById("total").innerText = "0";
    document.getElementById("minutos").innerHTML = "";
    document.getElementById("previsao").innerText = "Previsão: 0 cantos";

    atualizarTela();
}

atualizarTela();
</script>

</body>
</html>
