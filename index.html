<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contador de Cantos</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f2f2;
    margin: 0;
    padding: 10px;
}

#topo {
    text-align: center;
}

#tempo {
    font-size: 42px;
    font-weight: bold;
}

#controleTempo {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    margin-top: 10px;
}

.btnTempo {
    font-size: 24px;
    padding: 5px 12px;
}

#previsao {
    margin-top: 10px;
    font-size: 20px;
    font-weight: bold;
    color: #333;
}

#conteudo {
    display: flex;
    margin-top: 15px;
}

#minutos {
    width: 45%;
    font-size: 14px;
}

#contador {
    width: 55%;
    text-align: center;
}

#total {
    font-size: 48px;
    margin-bottom: 10px;
}

#botoes {
    position: fixed;
    bottom: 30px;
    left: 0;
    width: 100%;
    text-align: center;
}

#btnContar {
    width: 90%;
    height: 110px;
    font-size: 36px;
    background: green;
    color: white;
    border: none;
    border-radius: 15px;
}

#btnsPequenos {
    margin-top: 10px;
}

.btnSmall {
    font-size: 16px;
    padding: 8px 14px;
    margin: 0 5px;
}
</style>
</head>

<body>

<div id="topo">
    <div id="tempo">15:00</div>

    <div id="controleTempo">
        <button class="btnTempo" onclick="ajustarTempo(1)">▲</button>
        <span id="tempoMin">15 min</span>
        <button class="btnTempo" onclick="ajustarTempo(-1)">▼</button>
    </div>

    <div id="previsao">Previsão: 0 cantos</div>
</div>

<div id="conteudo">
    <div id="minutos"></div>

    <div id="contador">
        <div id="total">0</div>
    </div>
</div>

<div id="botoes">
    <button id="btnContar" onclick="contar()">CONTAR</button>

    <div id="btnsPequenos">
        <button class="btnSmall" onclick="pausar()">PAUSE</button>
        <button class="btnSmall" onclick="zerar()">ZERAR</button>
    </div>
</div>

<script>
let tempoTotal = 15 * 60;
let tempoRestante = tempoTotal;
let intervalo = null;
let totalCantos = 0;
let pausado = false;
let cantosPorMinuto = [];
let inicio = null;

function atualizarTela() {
    let min = Math.floor(tempoRestante / 60);
    let seg = tempoRestante % 60;
    document.getElementById("tempo").innerText =
        String(min).padStart(2, "0") + ":" + String(seg).padStart(2, "0");
}

function ajustarTempo(valor) {
    if (intervalo) return;
    let minutos = tempoTotal / 60 + valor;
    if (minutos < 1) return;
    tempoTotal = minutos * 60;
    tempoRestante = tempoTotal;
    document.getElementById("tempoMin").innerText = minutos + " min";
    atualizarTela();
}

function iniciarTimer() {
    intervalo = setInterval(() => {
        if (!pausado) {
            tempoRestante--;
            atualizarTela();
            atualizarPrevisao();
            atualizarMinutos();

            if (tempoRestante <= 0) {
                clearInterval(intervalo);
            }
        }
    }, 1000);
}

function contar() {
    if (navigator.vibrate) navigator.vibrate(50);

    if (!intervalo) {
        inicio = Date.now();
        iniciarTimer();
    }

    totalCantos++;
    document.getElementById("total").innerText = totalCantos;
}

function atualizarMinutos() {
    if (!inicio) return;

    let minutosPassados = Math.floor((Date.now() - inicio) / 60000);

    if (!cantosPorMinuto[minutosPassados]) {
        cantosPorMinuto[minutosPassados] = 0;
    }
}

function atualizarPrevisao() {
    if (!inicio) {
        document.getElementById("previsao").innerText = "Previsão: 0 cantos";
        return;
    }

    let tempoDecorrido = (Date.now() - inicio) / 1000;
    if (tempoDecorrido <= 0) return;

    let mediaPorSegundo = totalCantos / tempoDecorrido;
    let previsao = Math.round(mediaPorSegundo * tempoTotal);

    document.getElementById("previsao").innerText =
        "Previsão: " + previsao + " cantos";
}

function pausar() {
    pausado = !pausado;
}

function zerar() {
    clearInterval(intervalo);
    intervalo = null;
    tempoRestante = tempoTotal;
    totalCantos = 0;
    pausado = false;
    cantosPorMinuto = [];
    inicio = null;

    document.getElementById("total").innerText = "0";
    document.getElementById("minutos").innerHTML = "";
    document.getElementById("previsao").innerText = "Previsão: 0 cantos";
    atualizarTela();
}

setInterval(atualizarPrevisao, 5000);
atualizarTela();
</script>

</body>
</html>
